"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.DefaultNodeImpl=void 0;const path_1=__importDefault(require("path")),common_const_js_1=require("../options/common-const.js"),default_task_container_js_1=require("../internal/task/core/default-task-container.js"),task_directed_acyclic_graph_js_1=require("../internal/task/core/task-directed-acyclic-graph.js"),default_internal_task_js_1=require("../internal/task/core/default-internal-task.js"),default_plugin_container_js_1=require("../external/plugin/default-plugin-container.js"),noop_js_1=require("../util/noop.js"),class_type_const_js_1=require("../options/class-type-const.js");class DefaultNodeImpl{constructor(t,e){this.classKind=class_type_const_js_1.ClassTypeConst.HVIGOR_NODE,this._nodeName=t,this._nodePath=e,this._packageJsonPath=path_1.default.resolve(e,common_const_js_1.HvigorCommonConst.PACKAGE_JSON),this._buildFilePath=path_1.default.resolve(e,common_const_js_1.HvigorCommonConst.BUILD_FILE_NAME),this._taskGraph=new task_directed_acyclic_graph_js_1.TaskDirectedAcyclicGraph,this._taskContainer=new default_task_container_js_1.DefaultTaskContainer(t,this._taskGraph),this._pluginContainer=new default_plugin_container_js_1.DefaultPluginContainer}getBuildFilePath(){return this._buildFilePath}getNodeDir(){return this._nodePath}getName(){return this._nodeName}getPackageJsonPath(){return this._packageJsonPath}bindPlugin(t){return this._pluginContainer.registryPlugin(t)}getPluginById(t){return this._pluginContainer.getPluginById(t)}getAllTasks(){return this._taskContainer.getAllTasks()}getTaskByName(t){return this._taskContainer.findTask(t)}task(t,e){let a;a=void 0===e||"string"==typeof e?{name:e||"default"}:e;const s=t||noop_js_1.noop,n=new default_internal_task_js_1.DefaultInternalTask(this,a,s);return this._taskContainer.addTask(n),n}registry(t){return this._taskContainer.addTask(t),t}hasTask(t){return this._taskContainer.hasTask(t)}registryDependsOnTask(t,...e){for(const a of e)this._taskContainer.hasTask(a.getName())||this._taskContainer.addTask(a),t.addDependsOn(a.getName()),this._taskGraph.addEdge(t.getPath(),a.getPath()),task_directed_acyclic_graph_js_1.projectTaskDag.addEdge(t.getPath(),a.getPath())}getTaskContainer(){return this._taskContainer}getTaskGraph(){return this._taskGraph}}exports.DefaultNodeImpl=DefaultNodeImpl;