"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModuleTargetData=void 0;const build_directory_const_js_1=require("../../const/build-directory-const.js"),status_js_1=require("../service/status.js"),array_util_js_1=require("../../utils/array-util.js"),ohos_logger_js_1=require("../../utils/log/ohos-logger.js");class ModuleTargetData{constructor(e,t,r,o){this._moduleModel=e,this._target=t,this._pathInfo=r,this._product=o;const s=new status_js_1.Status(t);this._targetStatus=0===s.getStatusCode()?new status_js_1.Status(e.getProfileOpt()):s,this._moduleSourceSetModel=this._moduleModel.getSourceSetByTargetName(t.name)}getModuleModel(){return this._moduleModel}getModuleSourceSetModel(){return this._moduleSourceSetModel}getRelatedEntryModules(){return this.getModuleModel().getRelatedEntryModules()}getTargetName(){return this._target.name}getTargetOpt(){return this._target}getPathInfo(){return this._pathInfo}getModuleTargetOutputFileName(e,t,r=build_directory_const_js_1.BuildArtifactExtension.DOT_HAP){const o=this._moduleModel.getName(),s=""===e?"":`-${e}`;if(null===t)return`${o}${s}-${this._target.name}${r}`;const i=t?"signed":"unsigned";return`${o}${s}-${this._target.name}-${i}${r}`}getApkName(e=!1){const t=this._moduleModel.getModuleType(this.getTargetName());return e?`${this._moduleModel.getName()}-${this._target.name}-cut-${t}.apk`:`${this._moduleModel.getName()}-${this._target.name}-${t}.apk`}getTargetStatus(){return this._targetStatus}getProduct(){return this._product}findTargetDataByName(e){var t;const r=this._moduleModel.getModule().findModuleByName(e);if(void 0===r)return;return null===(t=r.getPluginById("com.ohos.hap").getTaskService())||void 0===t?void 0:t.findTargetDataByName(this.getTargetName())}findTargetConfigOpt(e){var t;return(0,array_util_js_1.getElementFromArr)(null===(t=this.getTargetOpt().source)||void 0===t?void 0:t.abilities,e.getName())}getTargetDeviceType(){var e;const t=null===(e=this.getTargetOpt().config)||void 0===e?void 0:e.deviceType;return void 0===t||0===t.length?this._moduleModel.getDeviceTypes():(t.every((e=>this._moduleModel.getDeviceTypes().includes(e)))||ohos_logger_js_1.OhosLogger.getLogger("target")._buildError("Invalid target deviceType.")._solution(`Make sure the value of '${this.getTargetName()}' deviceType in the build-profile.json5 file is a subset of deviceType of the module.`)._file(this._moduleModel.getProfilePath())._printErrorAndExit(this._moduleModel.getName()),t)}}exports.ModuleTargetData=ModuleTargetData;