"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PreBuildApp=void 0;const ohos_app_task_js_1=require("./task/ohos-app-task.js"),task_names_js_1=require("./common/task-names.js"),hvigor_base_1=require("@ohos/hvigor-base"),common_const_js_1=require("../const/common-const.js");var CommonTask=task_names_js_1.TaskNames.CommonTask;const ohos_logger_js_1=require("../utils/log/ohos-logger.js"),_log=ohos_logger_js_1.OhosLogger.getLogger("hvigor-preBuildApp");class PreBuildApp extends ohos_app_task_js_1.OhosAppTask{constructor(o,e){super(o,e,CommonTask.PRE_BUILD_APP)}doTaskAction(){this.checkConfigModuleStatus(),PreBuildApp.checkDebuggableStatus()}checkConfigModuleStatus(){if(void 0!==hvigor_base_1.hvigor.getExtraConfig().get("module")&&_log.errorMessageExit("Cannot support configure the 'module' with -p on the command line when you want to package the App."),0===this.service.getProductDataMap().size){const o=this.service.getTargetProduct().name;_log._buildError("An app contains at least one Hap.")._solution(`Check the build-profile.json of the root project, for at least one HAP module which has least configured one target with applyToProducts field containing the specified product:\n          ${o}`)._file(this.service.getProjectModel().getProfilePath())._printErrorAndExit()}}static checkDebuggableStatus(){void 0===hvigor_base_1.hvigor.getExtraConfig().get(common_const_js_1.CommonConst.DEBUGGABLE)&&hvigor_base_1.hvigor.getExtraConfig().set(common_const_js_1.CommonConst.DEBUGGABLE,"false")}initTaskDepends(){}}exports.PreBuildApp=PreBuildApp;